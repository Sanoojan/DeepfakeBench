# log dir
log_dir: logs_debug/dino

# model setting
pretrained: null
model_name: dino
backbone_name: vit

# backbone setting
backbone_config:
  mode: original
  num_classes: 2
  inc: 3
  dropout: false

# DINO backbone
dino_model: vit_large_patch16_dinov3 # not implemented correctly inside. For now hard coded
feat_dim: 1024

# dataset
aall_dataset: [FaceForensics++, FF-F2F, FF-DF, FF-FS, FF-NT, FaceShifter, DeepFakeDetection, Celeb-DF-v1, Celeb-DF-v2, DFDCP, DFDC, DeeperForensics-1.0, UADFV,WDF]
train_dataset: [FaceForensics++]
test_dataset: [FaceForensics++, Celeb-DF-v1, Celeb-DF-v2, DFDCP, DFDC,WDF,DeepFakeDetection,UADFV]

video_mode: true
clip_size: 8
test_clip_size: 8
compression: c23
train_batchSize: 8
test_batchSize: 8
workers: 8
frame_num: {'train': 32, 'test': 32}
resolution: 256
with_mask: false
with_landmark: false
with_flow: false   

# data augmentation
use_data_augmentation: true
data_aug:
  flip_prob: 0.5
  rotate_prob: 0.5
  rotate_limit: [-10, 10]
  blur_prob: 0.5
  blur_limit: [3, 7]
  brightness_prob: 0.5
  brightness_limit: [-0.1, 0.1]
  contrast_limit: [-0.1, 0.1]
  quality_lower: 40
  quality_upper: 100

# ImageNet normalization (IMPORTANT for DINO)
mean: [0.485, 0.456, 0.406]
std: [0.229, 0.224, 0.225]

classifier: PatchClS_3DConv_TopKFrame  # choose between 'linear', 'PatchTemporalClassifier','ClsDiffClassifier' , 'PatchClassifierCNN3D','PatchTemporalClassifierCNN3D', 'PatchClassifier3D2Conv' and 'PatchClassifier', 'PatchClassifierCNN3D_ATTN', 'PatchClassifier3DConv_TopK'
topk_percent: 0.1
spatio_temporal_patches: true  # whether to use spatio-temporal patches in PatchClassifier3DConv_TopK

# optimizer config
optimizer:
  classifier_only: true
  type: adam
  adam:
    lr: 0.0002
    beta1: 0.9
    beta2: 0.999
    eps: 0.00000001
    weight_decay: 0.0005
    amsgrad: false

# training config
lr_scheduler: null
nEpochs: 10
start_epoch: 0
save_epoch: 1
rec_iter: 100
logdir: ./logs
manualSeed: 1024
save_ckpt: true
save_feat: true

# loss function
loss_func: cross_entropy
losstype: null

additional_losses: [All_layer_CE,Patch_frame_MIL_ranking_all] # additional loss functions to use {options: [KL_loss, Selected_layer_CE, All_layer_CE]}
KL_loss:
  temperature: 2.0
  alpha: 0.5
Selected_layer_CE:
  layer: 0
Patch_MIL:
  alpha: 0.5
  mil_type: topk
  k: 5
Patch_Xray_CE:
  alpha: 0.5
  xray_importance: 2.0
  k: 5
Patch_Temporal_Xray:
  alpha: 0.2
  window: 3        # temporal window size
  k: 5  
Patch_Xray:
  alpha: 0.3        # moderate auxiliary strength
  k: 10             # top-K patches Ã— frames (MIL)  
Patch_consistency_loss:
  alpha: 0.1
  window: 3
  use_sigmoid_weight: false
  use_variance: false
  variance_weight: 1.0
  use_difference: false
  use_corr: true
  corr_weight: 1.0
  fake_patch_only: false
  fake_topk: 30
  fake_thresh: none
Patch_frame_CE:
  alpha: 0.5
  topk_percent: 0.2
All_layer_CE:
  ranking_margin: 1.0
  use_ranking_loss: false
  use_mean_pred: true
  CE_alpha: 0.0
Patch_continuity_loss:
  alpha: 0.02
  topk: 5
  spatial_radius: 1
Patch_continuity_flow_loss:
  alpha: 0.02 
  conf_thresh: 0.6
Patch_frame_MIL_ranking:
  alpha: 1.0
  margin: 1.0
  use_variable_margin: true
  use_sigmoid: false
  random_pairs: 500

Patch_frame_MIL_ranking_all:
  alpha: 1.0
  margin: 0.4
  use_variable_margin: true
  max_margin: 0.9
  min_margin: 0.1
  use_sigmoid: false
  topk_percent: 0.1


# metric
metric_scoring: auc

# cuda
cuda: true
cudnn: true
visualize_patchwise: true

apply_layernorm: true 