# import cv2
# import numpy as np
# import os


# def save_heat_colorbar_real_fake(
#     save_path="patch_score_colorbar.png",
#     height=256,
#     width=50,
#     cmap=cv2.COLORMAP_JET,
# ):
#     """
#     Saves a vertical heatmap colorbar with 'Real' (low) and 'Fake' (high) labels
#     """

#     # -----------------------------
#     # Create vertical gradient
#     # -----------------------------
#     gradient = np.linspace(255, 0, height, dtype=np.uint8).reshape(height, 1)

#     # Apply colormap
#     colorbar = cv2.applyColorMap(gradient, cmap)
#     colorbar = cv2.resize(
#         colorbar, (width, height), interpolation=cv2.INTER_NEAREST
#     )

#     # Convert BGR → RGB
#     colorbar = cv2.cvtColor(colorbar, cv2.COLOR_BGR2RGB)

#     # -----------------------------
#     # Add text labels
#     # -----------------------------
#     font = cv2.FONT_HERSHEY_SIMPLEX
#     font_scale = 1.0
#     thickness = 2
#     color = (255,255,255)  # black

#     # "Fake" (top = high score)
#     cv2.putText(
#         colorbar,
#         "R",
#         (14, 30),
#         font,
#         font_scale,
#         color,
#         thickness,
#         cv2.LINE_AA,
#     )

#     # "Real" (bottom = low score)
#     cv2.putText(
#         colorbar,
#         "F",
#         (14, height - 10),
#         font,
#         font_scale,
#         color,
#         thickness,
#         cv2.LINE_AA,
#     )

#     # -----------------------------
#     # Save
#     # -----------------------------
#     os.makedirs(os.path.dirname(save_path) or ".", exist_ok=True)
#     cv2.imwrite(save_path, colorbar)

#     print(f"Saved colorbar with labels to: {save_path}")
    
# save_heat_colorbar_real_fake(
#     save_path=os.path.join("patch_score_colorbar.png")
# )



import numpy as np
import matplotlib.pyplot as plt

def plot_prob_distribution(pred_prob, labels, bins=30):
    """
    pred_prob : np.ndarray, shape (N,) – predicted probability for class=1 (fake)
    labels    : np.ndarray, shape (N,) – 0 = real, 1 = fake
    """

    pred_prob = np.asarray(pred_prob)
    labels = np.asarray(labels)

    real_probs = pred_prob[labels == 0]
    fake_probs = pred_prob[labels == 1]

    plt.figure(figsize=(7, 5))
    plt.hist(
        real_probs,
        bins=bins,
        density=True,
        alpha=0.6,
        label="Real"
    )
    plt.hist(
        fake_probs,
        bins=bins,
        density=True,
        alpha=0.6,
        label="Fake"
    )

    plt.xlabel("Predicted Probability (Fake)")
    plt.ylabel("Density")
    plt.title("Prediction Probability Distribution_ranking_loss_only")
    plt.legend()
    plt.grid(True, linestyle="--", alpha=0.4)
    plt.tight_layout()
    plt.savefig("probability_distribution_ranking_loss_only.png")

# ------------------ Example usage ------------------
pred_prob = [9.99999881e-01, 4.41304735e-08, 1.19830752e-02, 1.15825296e-05,
       3.11283202e-06, 1.41499022e-05, 7.35066133e-03, 3.37296967e-07,
       5.50600351e-04, 5.13760315e-05, 1.70475396e-03, 5.18606394e-04,
       1.06135678e-06, 1.08738657e-10, 1.34049316e-07, 2.14450736e-07,
       8.39742853e-08, 2.71070633e-08, 2.24933228e-05, 7.08809728e-03,
       2.72887382e-06, 1.65199992e-06, 7.36649334e-01, 2.95162387e-02,
       4.63277800e-03, 6.98109943e-08, 1.12724797e-06, 4.78444178e-07,
       5.94434262e-08, 5.97398264e-09, 3.74733994e-04, 1.80434381e-05,
       9.86914933e-01, 3.56286414e-08, 9.66347337e-01, 9.99918103e-01,
       2.32838488e-07, 2.26150155e-06, 7.20239223e-06, 6.40030839e-06,
       1.90751889e-04, 1.31453735e-05, 7.97062083e-10, 5.87437717e-06,
       1.09113847e-04, 3.71277742e-09, 1.43394119e-03, 1.15682701e-06,
       2.66930783e-06, 2.06989284e-06, 1.26333477e-08, 1.95192248e-02,
       7.29600424e-06, 2.80778902e-03, 8.20324342e-09, 9.13296816e-08,
       1.70915570e-07, 5.27861594e-05, 6.84544668e-02, 7.21830176e-03,
       4.93106432e-03, 1.04695380e-06, 5.11627407e-09, 2.88026668e-02,
       2.69327103e-03, 6.80006560e-05, 7.97779951e-03, 1.26808871e-07,
       1.74857784e-09, 7.37769869e-06, 4.84849227e-09, 1.02423728e-04,
       2.70905588e-07, 7.37008986e-06, 8.16864656e-08, 1.13416418e-05,
       1.62375812e-07, 1.27724989e-03, 1.87234386e-04, 2.29402517e-07,
       5.58816460e-09, 9.30488051e-04, 2.64968094e-05, 5.73459387e-01,
       9.97357905e-01, 5.47974814e-05, 4.13891803e-06, 2.15822960e-09,
       3.22657212e-09, 2.69827782e-04, 3.37001635e-04, 6.20579362e-01,
       9.98381734e-01, 6.97120640e-06, 6.17386013e-06, 2.54795566e-07,
       3.29027767e-03, 5.96402833e-06, 5.00360535e-08, 5.76440051e-08,
       1.37668212e-05, 6.80924803e-02, 2.44125375e-03, 3.93193233e-07,
       5.52790916e-05, 4.05816905e-07, 8.50272318e-06, 9.99976277e-01,
       4.17057345e-05, 4.27277143e-07, 6.98442904e-08, 1.46761622e-07,
       8.94065033e-06, 9.95366454e-01, 5.47057986e-01, 1.08285334e-07,
       1.10870793e-07, 1.03498915e-05, 3.64709081e-08, 9.34748896e-05,
       3.80489240e-09, 6.28450834e-07, 3.60301601e-05, 8.27471986e-02,
       1.86725515e-08, 7.17088710e-07, 1.78081661e-01, 3.18008679e-04,
       5.78952546e-04, 2.08457903e-04, 7.44826252e-07, 2.98330747e-08,
       2.03073695e-02, 2.11445567e-07, 5.76617778e-04, 1.18772840e-08,
       4.25189637e-06, 1.63012199e-08, 1.12515837e-02, 4.66007122e-10,
       9.97082310e-08, 1.70536374e-09, 1.39283077e-06, 9.98164952e-01,
       2.45546472e-10, 6.50765316e-04, 4.73718363e-04, 6.08765777e-06,
       6.22796915e-06, 5.01596252e-04, 2.56891508e-05, 4.29083912e-06,
       2.15438529e-08, 4.12892405e-06, 6.53733686e-02, 2.59592593e-06,
       1.64622645e-06, 6.38932875e-07, 1.25238913e-07, 2.27829332e-06,
       9.97213304e-01, 4.89157657e-08, 1.00407219e-02, 4.52684006e-04,
       2.31819670e-03, 1.20064851e-06, 5.20053511e-08, 1.75434179e-05,
       2.53255575e-06, 4.15508657e-05, 1.24351357e-06, 2.93221115e-06,
       2.26138411e-07, 1.24406492e-04, 5.97181534e-05, 7.12155952e-08,
       3.26314931e-09, 8.24656710e-03, 1.70137398e-02, 9.14462760e-07,
       3.14422417e-04, 7.75123340e-07, 1.51224403e-05, 1.61032676e-05,
       5.78991467e-06, 1.63565874e-05, 1.05022825e-03, 4.51717675e-01,
       3.01702856e-03, 3.45681906e-01, 2.26503989e-08, 2.70006115e-08,
       7.85769522e-01, 1.22295087e-03, 4.98796071e-05, 1.16284155e-05,
       7.11362518e-05, 7.07823085e-04, 9.19706436e-05, 1.39110291e-03,
       3.62841492e-05, 3.08809134e-09, 1.52680735e-09, 9.99956727e-01,
       4.47931608e-10, 2.38123178e-01, 3.51001618e-05, 1.25578211e-07,
       2.37907699e-07, 1.40265477e-09, 4.55450504e-07, 4.43535653e-09,
       8.05702484e-07, 2.93436851e-02, 3.44415421e-05, 1.42838724e-03,
       5.61689239e-06, 9.99997258e-01, 7.18519323e-06, 9.12138034e-07,
       2.99380713e-06, 1.39476936e-02, 9.99923587e-01, 2.00182203e-05,
       4.96516586e-04, 4.38486412e-02, 2.34206254e-08, 7.41026653e-08,
       4.21771392e-06, 4.44582329e-05, 2.90003827e-05, 4.83913063e-05,
       2.07317683e-07, 1.32702726e-05, 1.36792835e-07, 2.13816236e-07,
       4.77362221e-07, 3.54272544e-07, 1.56270534e-08, 2.95660953e-04,
       9.92556512e-01, 9.72659109e-09, 7.34413916e-05, 3.45187436e-05,
       2.25298291e-09, 4.49470008e-08, 2.51469010e-05, 9.34772856e-07,
       2.79672552e-09, 7.38288364e-08, 4.40295578e-09, 3.02728949e-06,
       5.65918246e-09, 2.77971537e-07, 1.92505740e-06, 5.49446523e-01,
       1.95895481e-07, 1.96586654e-01, 5.75082701e-08, 2.34293184e-05,
       1.65032761e-05, 1.73183032e-08, 2.33636821e-09, 2.49800196e-05,
       8.98350263e-05, 1.01958879e-03, 8.66970047e-03, 2.03032879e-09,
       9.64739229e-07, 2.66194227e-04, 1.14082405e-02, 8.99177883e-03,
       3.37730235e-05, 6.55988757e-08, 1.98688076e-06, 2.94652073e-05,
       1.07590186e-05, 2.67305859e-05, 9.99999523e-01, 1.01742793e-04,
       2.12722125e-06, 4.76688692e-05, 2.32064440e-06, 5.30480065e-05,
       3.33717800e-08, 3.85005806e-05, 2.56270312e-08, 5.42462245e-03,
       2.15741347e-05, 1.09475468e-05, 1.25761318e-04, 8.36859457e-04,
       2.21638093e-05, 3.36621852e-05, 1.06146815e-03, 2.52075824e-06,
       7.33919535e-03, 1.51421188e-03, 3.49049333e-06, 7.28548031e-08,
       3.63509520e-03, 1.87137666e-05, 7.73011379e-07, 4.20975666e-05,
       6.87116097e-09, 3.21801162e-05, 3.27659748e-08, 4.08754544e-03,
       8.80940598e-10, 1.14326499e-01, 2.07019553e-07, 7.83157884e-06,
       2.73723690e-05, 2.31080025e-01, 1.96201916e-04, 3.02078538e-02,
       1.00305340e-06, 1.28539541e-04, 9.60485486e-05, 9.34657010e-07,
       5.34598529e-01, 2.71804595e-07, 2.94396500e-06, 1.95716843e-02,
       3.78443277e-03, 1.56495204e-07, 5.76017678e-09, 6.04271154e-05,
       3.21038510e-06, 9.13342220e-08, 4.29109677e-05, 1.50266914e-07,
       3.50738446e-06, 1.88596528e-02, 2.23820334e-05, 3.90567365e-08,
       1.64086122e-09, 3.13766504e-05, 9.94181693e-01, 7.42992006e-06,
       6.62821151e-07, 4.46162130e-06, 1.30271204e-07, 1.75182709e-06,
       1.13719016e-01, 1.95238134e-03, 2.51658726e-03, 1.42730846e-06,
       1.69011173e-06, 9.93505836e-01, 1.02934882e-03, 2.76561877e-07,
       2.80563728e-09, 3.44238797e-04, 3.45528126e-03, 9.99915481e-01,
       4.11365555e-08, 2.09651515e-03, 9.06632631e-05, 5.07411128e-03,
       4.94653650e-05, 9.16983754e-06, 9.82088316e-03, 6.79357299e-07,
       1.00447587e-05, 7.49372248e-06, 3.96557996e-04, 4.05871235e-02,
       4.90237335e-06, 5.82757522e-04, 1.48781078e-06, 6.04118221e-02,
       1.20093318e-07, 2.11585956e-07, 9.99940991e-01, 9.05159116e-02,
       2.67576921e-04, 1.27848466e-06, 5.37404412e-06, 4.25137092e-10,
       6.84048530e-07, 1.12125687e-08, 2.95066482e-09, 6.74806370e-06,
       4.60257041e-08, 4.75727484e-06, 9.71817204e-09, 5.91424480e-03,
       3.31641972e-01, 6.33864238e-06, 1.26785801e-06, 1.35002367e-03,
       4.25234088e-04, 1.32034552e-06, 2.48570387e-07, 1.21242522e-06,
       3.81471327e-04, 4.82232068e-08, 1.41821477e-06, 2.18380919e-07,
       1.93514479e-05, 2.91147444e-05, 3.97761614e-04, 6.35527567e-06,
       2.10106329e-04, 3.63241588e-06, 5.80313429e-03, 6.16466999e-02,
       7.08518147e-01, 1.63101532e-07, 5.48215292e-04, 3.69983333e-09,
       4.79042285e-07, 1.49368873e-08, 1.26654768e-05, 2.21847040e-05,
       5.99746630e-02, 5.90274930e-01, 1.47636310e-04, 2.50268045e-06,
       5.85239759e-05, 1.60844659e-03, 9.86693334e-03, 7.41923213e-01,
       1.82581221e-06, 5.18671222e-05, 2.00673568e-07, 7.27727866e-07,
       1.19874712e-05, 2.11563990e-01, 2.64581962e-04, 1.04980018e-06,
       6.04617635e-05, 9.33907032e-08, 5.31090745e-06, 1.73422450e-03,
       4.14557318e-04, 1.23906400e-04, 2.39050382e-06, 7.07131539e-06,
       1.43372745e-04, 2.91449074e-02, 9.99999762e-01, 1.99434999e-03,
       8.19025189e-02, 1.61139804e-04, 1.17854271e-02, 4.88123369e-05,
       6.83195278e-10, 1.09283114e-03, 1.42019635e-05, 6.28411328e-07,
       5.61010393e-06, 6.31387877e-07, 9.99801457e-01, 7.16054132e-08,
       2.94046714e-07, 1.02349720e-03, 4.71450476e-05, 5.59862144e-07,
       2.96966697e-04, 6.74484045e-06, 2.83436584e-05, 4.08486603e-03,
       9.67246056e-01, 5.45615051e-03, 1.74103323e-02, 9.99983668e-01,
       2.78012863e-07, 4.33662426e-05, 3.46133817e-07, 5.84787131e-06,
       6.67392313e-02, 1.58383802e-04, 6.05907023e-01, 3.12521644e-02]
label=[1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0,
       1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0,
       1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0,
       1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0,
       0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0,
       1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1,
       1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0,
       0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1,
       1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1,
       1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0,
       1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1,
       1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1,
       0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1,
       0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1,
       1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0,
       0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0,
       1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1,
       1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1]


plot_prob_distribution(pred_prob, label)